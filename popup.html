<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Ned - CVSS Calculator</title>
    <link rel="stylesheet" href="popup.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
</head>

<body>
    <div class="app-container">
        <header>
            <h1>Ned <span class="subtitle">CVSS Calculator</span><span id="app-version" class="app-version"></span></h1>
            <div class="score-display">
                <span class="score-emoji" id="final-emoji">üò¥</span>
                <span class="score-value" id="final-score">0.0</span>
                <span class="score-severity" id="final-severity">None</span>
                <button id="reset-btn" class="icon-btn" title="Reset score">‚Üª</button>
            </div>
            <div class="vector-display-container">
                <button id="edit-vector-btn" class="icon-btn" title="Edit Vector String">‚úé</button>
                <div class="vector-display" id="vector-string" title="Click to copy, Double click to edit">
                    CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:N
                </div>
                <input type="text" id="vector-input" class="vector-edit-input" style="display: none;" />
                <span id="copied-badge" class="copied-badge">Copied!</span>
            </div>
        </header>

        <nav class="tabs">
            <button class="tab-btn active" data-tab="cvss3">CVSS 3.1</button>
            <button class="tab-btn" data-tab="cvss4">CVSS 4.0</button>
            <button class="tab-btn" data-tab="about">About</button>
        </nav>

        <main>
            <!-- CVSS 3.1 Tab Content -->
            <section id="cvss3" class="tab-content active">
                <div class="metrics-group">
                    <h2>Base Metrics</h2>

                    <div class="metric">
                        <strong class="metric-label">Attack Vector (AV)</strong>
                        <div class="metric-options" data-metric="3_AV">
                            <button class="opt-btn" data-val="N" title="Network">N</button>
                            <button class="opt-btn" data-val="A" title="Adjacent">A</button>
                            <button class="opt-btn" data-val="L" title="Local">L</button>
                            <button class="opt-btn" data-val="P" title="Physical">P</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Attack Complexity (AC)</strong>
                        <div class="metric-options" data-metric="3_AC">
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Privileges Required (PR)</strong>
                        <div class="metric-options" data-metric="3_PR">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">User Interaction (UI)</strong>
                        <div class="metric-options" data-metric="3_UI">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="R" title="Required">R</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Scope (S)</strong>
                        <div class="metric-options" data-metric="3_S">
                            <button class="opt-btn" data-val="U" title="Unchanged">U</button>
                            <button class="opt-btn" data-val="C" title="Changed">C</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Confidentiality (C)</strong>
                        <div class="metric-options" data-metric="3_C">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Integrity (I)</strong>
                        <div class="metric-options" data-metric="3_I">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Availability (A)</strong>
                        <div class="metric-options" data-metric="3_A">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                        </div>
                    </div>
                </div>
                <!-- Temporal and Environmental omitted for brevity, adding only Base for now to keep UI clean, can add later if req -->
            </section>

            <!-- CVSS 4.0 Tab Content -->
            <section id="cvss4" class="tab-content">
                <div class="metrics-group">
                    <h2>Base Metrics</h2>

                    <div class="metric">
                        <strong class="metric-label">Attack Vector (AV)</strong>
                        <div class="metric-options" data-metric="4_AV">
                            <button class="opt-btn" data-val="N" title="Network">N</button>
                            <button class="opt-btn" data-val="A" title="Adjacent">A</button>
                            <button class="opt-btn" data-val="L" title="Local">L</button>
                            <button class="opt-btn" data-val="P" title="Physical">P</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Attack Complexity (AC)</strong>
                        <div class="metric-options" data-metric="4_AC">
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Attack Requirements (AT)</strong>
                        <div class="metric-options" data-metric="4_AT">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="P" title="Present">P</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Privileges Required (PR)</strong>
                        <div class="metric-options" data-metric="4_PR">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">User Interaction (UI)</strong>
                        <div class="metric-options" data-metric="4_UI">
                            <button class="opt-btn" data-val="N" title="None">N</button>
                            <button class="opt-btn" data-val="P" title="Passive">P</button>
                            <button class="opt-btn" data-val="A" title="Active">A</button>
                        </div>
                    </div>

                    <h2 style="margin-top: 24px;">Vulnerable System Impact Metrics</h2>

                    <div class="metric">
                        <strong class="metric-label">Vuln. Confidentiality (VC)</strong>
                        <div class="metric-options" data-metric="4_VC">
                            <button class="opt-btn" data-val="H" title="High">H</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="N" title="None">N</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Vuln. Integrity (VI)</strong>
                        <div class="metric-options" data-metric="4_VI">
                            <button class="opt-btn" data-val="H" title="High">H</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="N" title="None">N</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Vuln. Availability (VA)</strong>
                        <div class="metric-options" data-metric="4_VA">
                            <button class="opt-btn" data-val="H" title="High">H</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="N" title="None">N</button>
                        </div>
                    </div>

                    <h2 style="margin-top: 24px;">Subsequent System Impact Metrics</h2>

                    <div class="metric">
                        <strong class="metric-label">Sub. Confidentiality (SC)</strong>
                        <div class="metric-options" data-metric="4_SC">
                            <button class="opt-btn" data-val="H" title="High">H</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="N" title="None">N</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Sub. Integrity (SI)</strong>
                        <div class="metric-options" data-metric="4_SI">
                            <button class="opt-btn" data-val="S" title="Safety">S</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="N" title="None">N</button>
                        </div>
                    </div>

                    <div class="metric">
                        <strong class="metric-label">Sub. Availability (SA)</strong>
                        <div class="metric-options" data-metric="4_SA">
                            <button class="opt-btn" data-val="S" title="Safety">S</button>
                            <button class="opt-btn" data-val="H" title="High">H</button>
                            <button class="opt-btn" data-val="L" title="Low">L</button>
                            <button class="opt-btn" data-val="N" title="None">N</button>
                        </div>
                    </div>

                </div>
            </section>

            <!-- About Tab Content -->
            <section id="about" class="tab-content">
                <div class="about-container">
                    <h2>Ned</h2>
                    <p class="tagline">"I'm the guy in the chair."</p>
                    <img src="images/guy-in-chair.webp" alt="Ned, the guy in the chair" class="about-image">
                    <div class="info-card">
                        <p><strong>Offline & Private:</strong> Embedded FIRST.org and Red Hat JavaScript calculation
                            mechanics guarantee your assessments remain securely on your local device. Zero external
                            data collection.</p>
                        <div class="legal-disclaimer">
                            <strong>Acknowledgements:</strong><br>
                            ‚Ä¢ CVSS v3.1: Copyright (c) 2019, FIRST.ORG, INC. (BSD-2-Clause)<br>
                            ‚Ä¢ CVSS v4.0: Copyright FIRST, Red Hat, contributors. (SPDX: BSD-2-Clause)
                        </div>
                    </div>

                    <div class="social-links">
                        <a href="https://github.com/br0wnboi/ned-cvss-calculator" target="_blank" class="social-btn">
                            <span class="social-icon">{'</>'}</span> Source Code
                        </a>
                        <a href="https://github.com/br0wnboi" target="_blank" class="social-btn">
                            <span class="social-icon">üêô</span> GitHub
                        </a>
                        <a href="https://x.com/br0wnboi" target="_blank" class="social-btn">
                            <span class="social-icon">ùïè</span> Profile
                        </a>
                        <!-- Placeholder for Support: Uncomment when ready -->
                        <!-- <a href="https://ko-fi.com/br0wnboi" target="_blank" class="social-btn kofi-btn">
                             <span class="social-icon">‚òï</span> Buy me a coffee
                        </a> -->
                    </div>

                    <div class="credits">
                        <p>Made by <strong>br0wnboi</strong> ‚Ä¢ <a href="privacy.html" target="_blank"
                                class="privacy-link">Privacy Policy</a></p>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script src="lib/cvsscalc31.js"></script>
    <script src="lib/cvsscalc31_helptext.js"></script>
    <script src="lib/cvsscalc40.js"></script>
    <script src="lib/cvsscalc40_helptext.js"></script>
    <script src="popup.js"></script>

    <!-- Custom Toast Notification -->
    <div id="toast" class="toast-notification"></div>
</body>

</html>